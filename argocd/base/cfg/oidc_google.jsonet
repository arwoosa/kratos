local claims = {
  email_verified: false,
} + std.extVar('claims');

if std.length(claims.sub) == 0 then
  error 'claim sub not set'
else
  {
    identity: {
      traits: {
        email: claims.email,
        name: claims.name,
        picture: claims.picture
      },
      verified_addresses: std.prune([
        if 'email' in claims && claims.email_verified then { via: 'email', value: claims.email },
      ]),
    },
    
  }

